# 設計メモ

## 概要
- Webアプリとして実装する。
- Moonbit言語の習作として作成する。
- 仕様の詳細は`docs/specification.md`および`docs/datore-specification.md`に準拠する。

## 対象とする出題データ
- 単語データは`docs/datore-specification.md`にあるものを使用する。
- まずは「高速タイピング」向けのデータに対応する。

## 入力方式（ローマ字入力）
- 初期実装はhiggsinoを利用する。
- 不備があれば自作実装に切り替えていく。
- 今後複数のタイピングゲームで再利用するため、ローマ字入力方式の対応方針は別途整理していく。

## 計測・リザルト指標
- 打鍵数とミス数を表示する（打鍵トレーナー準拠）。

## 画面・体験
- Monkeytypeのように文字が流れるプレイ体験を目指す。
- プレイ終了後に数値とグラフで結果を表示する。
- 画面構成はタイトル/ゲーム/結果の3画面とする。

## 画面構成と状態遷移
- タイトル: 時間設定・フィルタ設定を行い、入力を始めるとゲームが開始する。
- ゲーム: 入力と進行、タイマー、スコア更新を行う。終了条件で結果へ遷移する。
- 結果: 成績（数値/グラフ）を表示し、再挑戦でゲーム、戻るでタイトルへ遷移する。

## 画面ラフ（ワイヤー）

### タイトル

```
+--------------------------------------------------+
| D a t o r e - W e l l                            |
|--------------------------------------------------|
| 時間: [15] [30] [60] [120]                       |
| 分類: [全て] [漢字] [カタカナ] [ひらがな]        |
| 絞り込み: [____________________]                 |
|                                                  |
| 生活  存在  彼  完走  可能性  調子  時間 ...     |
|                                                  |
|             (入力で開始)                         |
+--------------------------------------------------+
```

### ゲーム

```
+--------------------------------------------------+
| 残り時間: 49   打鍵数: 120   ミス数: 3           |
|--------------------------------------------------|
| 生活  存在  彼  完走  可能性  調子  時間 ...     |
|  ↑ 現在の位置                                   |
|--------------------------------------------------|
| 入力:  seikatu sonzai kare kanousei tyousi jikan |
|--------------------------------------------------|
| [Escで中断 / タイムアップで終了]                 |
+--------------------------------------------------+
```

### 結果

```
+--------------------------------------------------+
| R e s u l t                                      |
|--------------------------------------------------|
| 打鍵数: 120   ミス数: 3   正確性: 92%            |
| グラフ: 文字/秒（簡易）                          |
|  ▁▃▅▇▆▅▃▂▁▂▃▅▆▇▆▅▃▂            |
|--------------------------------------------------|
| [ R E T R Y ]   [ T I T L E ]                    |
+--------------------------------------------------+
```

## UIデザイン
- 装飾をできるだけ排除し、シンプルなデザインにする。
- Tailwind CSSを利用する。

## フレームワーク
- UIフレームワークはRabbit-TEAを採用する。
- Rabbit-TEAの構成に合わせて画面と状態管理を設計する。

## Rabbit-TEAの流れ整理
- Model: 画面状態（タイトル/ゲーム/結果）と入力中の文字列、タイマー、統計値を保持する。
- Msg: キー入力・開始/終了・タイマー進行・画面遷移などのイベント種別を表す。
- Update: Msgに応じてModelを更新し、必要に応じてCmdを返す。
- View: ModelをHTMLに変換し、操作イベントをMsgに結び付ける。

### 入力イベントの基本フロー
1. キー入力を受ける
2. Msg（例: KeyPressed）を生成
3. Updateで入力判定・状態更新
4. Model更新後にView再描画

### Cmdの使いどころ
- タイマーの開始/停止、一定間隔の更新
- 将来的なデータ読み込みや保存などの副作用

### 画面遷移の考え方（案）
- Modelに画面状態（Title/Game/Result）を持たせる
- Msgで遷移イベント（Start/Finish/Retry/Back）を受ける
- Updateで画面状態を切り替える

## デプロイ
- Cloudflare Workersにデプロイする。
